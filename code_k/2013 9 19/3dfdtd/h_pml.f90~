subroutine h_pml
  use fdtd
  implicit none
  integer :: l,i,j,k
  
  do l=1,6

     i0=lpmlii(l,1)
     i1=lpmlii(l,2)
     j0=lpmljj(l,1)
     j1=lpmljj(l,2)
     k0=lpmlkk(l,1)
     k1=lpmlkk(l,2)

!     l1=lpmlst(l)
     do i=i0,i1-1
        do j=j0+1,j1-1
           do k=k0+1,k1-1
              hxy(l1)=cyh(j)*hxy(l1)+cyhl(j)*(ez(i,j,k)-ez(i,j-1,k))
              hxz(l1)=czh(k)*hxz(l1)+czhl(k)*(ey(i,j,k-1)-ey(i,j,k))
              hx(i,j,k)=hxy(l1)+hxz(l1)
!              l1=l1+1
           end do
        end do
     end do

!     l2=lpmlst(l)
     do i=i0+1,i1-1
        do j=j0,j1-1
           do k=k0+1,k1-1
              hyx(l2)=cxh(i)*hyx(l2)+cxhl(i)*(ez(i-1,j,k)-ez(i,j,k))
              hyz(l2)=czh(k)*hyz(l2)+cyhl(k)*(ex(i,j,k)-ex(i,j,k-1))
              hy(i,j,k)=hyx(l2)+hyz(l2)
!              l2=l2+1
           end do
        end do
     end do

!      l3=lpmlst(l)
     do i=i0+1,i1-1
        do j=j0+1,j1-1
           do k=k0,k1-1
              hzx(l3)=cxh(i)*hzx(l3)+cxhl(i)*(ey(i,j,k)-ey(i-1,j,k))
              hzy(l3)=cyh(j)*hzy(l3)+cyhl(j)*(ex(i,j-1,k)-ex(i,j,k))
              hz(i,j,k)=hzx(l3)+hzy(l3)
!              l3=l3+1
           end do
        end do
     end do
  end do

end subroutine
